<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä»£ç æ ¼å¼åŒ–å·¥å…· - AIæ™ºèƒ½æŠ€æœ¯çŸ¥è¯†å¹³å°</title>
  <meta name="description" content="æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œæä¾›è¯­æ³•é«˜äº®ã€ä»£ç ç¾åŒ–å’Œå‹ç¼©åŠŸèƒ½">
  <meta name="keywords" content="ä»£ç æ ¼å¼åŒ–,ä»£ç ç¾åŒ–,JavaScriptæ ¼å¼åŒ–,Pythonæ ¼å¼åŒ–,è¯­æ³•é«˜äº®,ä»£ç å‹ç¼©">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --gold-main: #d4af37;
      --gold-light: #f4d03f;
      --gold-dark: #b8960f;
      --bg-primary: #0a0a0a;
      --bg-secondary: #1a1a1a;
      --bg-tertiary: #2a2a2a;
      --text-primary: #e0e0e0;
      --text-secondary: #c5c5c5;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #2d1f0c 100%);
      color: var(--text-primary);
      padding: 20px;
      min-height: 100vh;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      color: var(--gold-main);
      text-decoration: none;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 20px;
      border: 2px solid var(--gold-dark);
      border-radius: 25px;
      transition: all 0.3s ease;
      background: rgba(212, 175, 55, 0.1);
      margin-bottom: 20px;
    }

    .back-link:hover {
      color: var(--gold-light);
      border-color: var(--gold-light);
      transform: translateX(-5px);
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
    }

    .header {
      text-align: center;
      padding: 30px 0;
      margin-bottom: 30px;
      border-bottom: 2px solid var(--gold-main);
    }

    .header h1 {
      color: var(--gold-light);
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 0 2px 10px rgba(244, 208, 63, 0.3);
    }

    .header p {
      color: var(--text-secondary);
      font-size: 1.1em;
    }

    /* æç¤ºæ¡† */
    .tip-box {
      background: rgba(244, 208, 63, 0.1);
      border: 2px solid var(--gold-main);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .tip-icon {
      font-size: 40px;
      flex-shrink: 0;
    }

    .tip-content h3 {
      color: var(--gold-light);
      margin-bottom: 8px;
      font-size: 1.1em;
    }

    .tip-content p {
      color: var(--text-secondary);
      margin: 0;
      font-size: 14px;
    }

    /* å·¥å…·å®¹å™¨ */
    .tool-container {
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      border: 2px solid var(--gold-main);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
    }

    /* è¯­è¨€é€‰æ‹©å’Œæ“ä½œæŒ‰é’® */
    .controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 25px;
      align-items: center;
    }

    .language-select {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .language-select label {
      color: var(--gold-main);
      font-weight: 600;
    }

    select {
      background: var(--bg-tertiary);
      border: 2px solid var(--gold-dark);
      border-radius: 8px;
      padding: 10px 15px;
      color: var(--text-primary);
      font-size: 14px;
      cursor: pointer;
      min-width: 150px;
    }

    select:focus {
      outline: none;
      border-color: var(--gold-main);
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      flex: 1;
      justify-content: center;
    }

    button {
      background: linear-gradient(135deg, var(--gold-dark), var(--gold-main));
      color: #000;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(212, 175, 55, 0.4);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(212, 175, 55, 0.6);
      background: linear-gradient(135deg, var(--gold-main), var(--gold-light));
    }

    button.secondary {
      background: var(--bg-tertiary);
      color: var(--gold-main);
      border: 2px solid var(--gold-dark);
    }

    button.secondary:hover {
      background: rgba(212, 175, 55, 0.2);
      border-color: var(--gold-main);
    }

    button.danger {
      background: rgba(220, 53, 69, 0.8);
      color: #fff;
    }

    button.danger:hover {
      background: rgba(220, 53, 69, 1);
    }

    /* ç¼–è¾‘å™¨åŒºåŸŸ */
    .editor-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 900px) {
      .editor-wrapper {
        grid-template-columns: 1fr;
      }
    }

    .editor-section {
      display: flex;
      flex-direction: column;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px 15px;
      background: var(--bg-tertiary);
      border-radius: 8px 8px 0 0;
      border: 2px solid var(--gold-dark);
      border-bottom: none;
    }

    .section-label {
      color: var(--gold-main);
      font-weight: 600;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .char-count {
      color: var(--text-secondary);
      font-size: 13px;
    }

    .code-editor {
      width: 100%;
      min-height: 400px;
      background: var(--bg-primary);
      border: 2px solid var(--gold-dark);
      border-radius: 0 0 8px 8px;
      padding: 15px;
      color: var(--text-primary);
      font-family: 'Consolas', 'Monaco', 'Fira Code', monospace;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      tab-size: 2;
    }

    .code-editor:focus {
      outline: none;
      border-color: var(--gold-main);
      box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
    }

    /* é«˜äº®é¢„è§ˆåŒº */
    .preview-container {
      width: 100%;
      min-height: 400px;
      background: var(--bg-primary);
      border: 2px solid var(--gold-dark);
      border-radius: 0 0 8px 8px;
      padding: 15px;
      overflow: auto;
      font-family: 'Consolas', 'Monaco', 'Fira Code', monospace;
      font-size: 14px;
      line-height: 1.6;
    }

    .preview-container pre {
      margin: 0;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    /* è¯­æ³•é«˜äº®é¢œè‰² */
    .token-keyword { color: #c792ea; }
    .token-string { color: #c3e88d; }
    .token-number { color: #f78c6c; }
    .token-comment { color: #546e7a; font-style: italic; }
    .token-function { color: #82aaff; }
    .token-class { color: #ffcb6b; }
    .token-operator { color: #89ddff; }
    .token-punctuation { color: #89ddff; }
    .token-property { color: #f07178; }
    .token-variable { color: #eeffff; }
    .token-tag { color: #f07178; }
    .token-attribute { color: #ffcb6b; }
    .token-decorator { color: #c792ea; }

    /* çŠ¶æ€æç¤º */
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: var(--bg-tertiary);
      border-radius: 8px;
      margin-top: 20px;
    }

    .status-message {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .status-message.success {
      color: #4caf50;
    }

    .status-message.error {
      color: #f44336;
    }

    /* Toasté€šçŸ¥ */
    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
      border: 2px solid var(--gold-main);
      border-radius: 12px;
      padding: 15px 25px;
      color: var(--text-primary);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    .toast.success {
      border-color: #4caf50;
    }

    .toast.error {
      border-color: #f44336;
    }

    /* å¿«æ·é”®æç¤º */
    .shortcuts-hint {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
      padding: 15px;
      background: rgba(212, 175, 55, 0.1);
      border-radius: 8px;
    }

    .shortcut-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .shortcut-key {
      background: var(--bg-tertiary);
      border: 1px solid var(--gold-dark);
      border-radius: 4px;
      padding: 3px 8px;
      font-family: monospace;
      color: var(--gold-main);
    }

    /* é¡µè„š */
    .footer {
      text-align: center;
      padding: 30px 20px;
      margin-top: 40px;
      border-top: 1px solid var(--bg-tertiary);
      color: var(--text-secondary);
    }

    .footer a {
      color: var(--gold-main);
      text-decoration: none;
    }

    .footer a:hover {
      color: var(--gold-light);
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8em;
      }

      .controls-row {
        flex-direction: column;
        align-items: stretch;
      }

      .language-select {
        justify-content: center;
      }

      .button-group {
        justify-content: center;
      }

      button {
        padding: 10px 16px;
        font-size: 13px;
      }

      .tip-box {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="/tools/" class="back-link">â† è¿”å›å·¥å…·é›†</a>

    <div class="header">
      <h1>{ } ä»£ç æ ¼å¼åŒ–å·¥å…·</h1>
      <p>æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç ç¾åŒ–ã€æ ¼å¼åŒ–ä¸å‹ç¼©</p>
    </div>

    <div class="tip-box">
      <div class="tip-icon">ğŸ’¡</div>
      <div class="tip-content">
        <h3>ä½¿ç”¨æç¤º</h3>
        <p>åœ¨å·¦ä¾§è¾“å…¥æˆ–ç²˜è´´ä»£ç ï¼Œé€‰æ‹©å¯¹åº”çš„ç¼–ç¨‹è¯­è¨€ï¼Œç‚¹å‡»"æ ¼å¼åŒ–"æŒ‰é’®å³å¯ç¾åŒ–ä»£ç ã€‚æ”¯æŒ JavaScriptã€Pythonã€Javaã€C++ ç­‰å¤šç§è¯­è¨€ã€‚</p>
      </div>
    </div>

    <div class="tool-container">
      <!-- æ§åˆ¶æ  -->
      <div class="controls-row">
        <div class="language-select">
          <label for="language">ç¼–ç¨‹è¯­è¨€:</label>
          <select id="language">
            <option value="javascript">JavaScript</option>
            <option value="python">Python</option>
            <option value="java">Java</option>
            <option value="cpp">C / C++</option>
            <option value="csharp">C#</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
            <option value="json">JSON</option>
            <option value="sql">SQL</option>
            <option value="go">Go</option>
            <option value="rust">Rust</option>
            <option value="php">PHP</option>
          </select>
        </div>

        <div class="button-group">
          <button onclick="formatCode()" title="æ ¼å¼åŒ–ä»£ç  (Ctrl+Shift+F)">
            <span>âœ¨</span> æ ¼å¼åŒ–
          </button>
          <button onclick="minifyCode()" class="secondary" title="å‹ç¼©ä»£ç ">
            <span>ğŸ“¦</span> å‹ç¼©
          </button>
          <button onclick="copyOutput()" class="secondary" title="å¤åˆ¶ç»“æœ (Ctrl+Shift+C)">
            <span>ğŸ“‹</span> å¤åˆ¶ç»“æœ
          </button>
          <button onclick="clearAll()" class="danger" title="æ¸…ç©ºæ‰€æœ‰">
            <span>ğŸ—‘ï¸</span> æ¸…ç©º
          </button>
        </div>
      </div>

      <!-- ç¼–è¾‘å™¨åŒºåŸŸ -->
      <div class="editor-wrapper">
        <div class="editor-section">
          <div class="section-header">
            <span class="section-label">ğŸ“ è¾“å…¥ä»£ç </span>
            <span class="char-count" id="inputCount">0 å­—ç¬¦</span>
          </div>
          <textarea 
            class="code-editor" 
            id="inputCode" 
            placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´ä»£ç ..."
            spellcheck="false"
          ></textarea>
        </div>

        <div class="editor-section">
          <div class="section-header">
            <span class="section-label">ğŸ¨ æ ¼å¼åŒ–ç»“æœ (è¯­æ³•é«˜äº®)</span>
            <span class="char-count" id="outputCount">0 å­—ç¬¦</span>
          </div>
          <div class="preview-container" id="outputPreview">
            <pre id="highlightedCode"></pre>
          </div>
        </div>
      </div>

      <!-- çŠ¶æ€æ  -->
      <div class="status-bar">
        <span class="status-message" id="statusMessage">å°±ç»ª</span>
        <span id="formatInfo" style="color: var(--text-secondary); font-size: 13px;"></span>
      </div>

      <!-- å¿«æ·é”®æç¤º -->
      <div class="shortcuts-hint">
        <div class="shortcut-item">
          <span class="shortcut-key">Ctrl + Shift + F</span>
          <span>æ ¼å¼åŒ–ä»£ç </span>
        </div>
        <div class="shortcut-item">
          <span class="shortcut-key">Ctrl + Shift + C</span>
          <span>å¤åˆ¶ç»“æœ</span>
        </div>
        <div class="shortcut-item">
          <span class="shortcut-key">Tab</span>
          <span>æ’å…¥ç¼©è¿›</span>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>Â© 2024-2026 AIæ™ºèƒ½æŠ€æœ¯çŸ¥è¯†å¹³å° | 
        <a href="https://github.com/wychmod/wychmod.github.io" target="_blank">GitHub</a> | 
        <a href="/tools/">æ›´å¤šå·¥å…·</a>
      </p>
    </div>
  </div>

  <!-- Toast é€šçŸ¥ -->
  <div class="toast" id="toast"></div>

  <script>
    // é»˜è®¤ç¤ºä¾‹ä»£ç 
    const defaultExamples = {
      javascript: `function calculateSum(arr){if(!arr||arr.length===0){return 0}let total=0;for(let i=0;i<arr.length;i++){total+=arr[i]}return total}const numbers=[1,2,3,4,5];const result=calculateSum(numbers);console.log("Sum:",result);class Person{constructor(name,age){this.name=name;this.age=age}greet(){return "Hello, my name is "+this.name}}const person=new Person("Alice",25);`,
      python: `def quicksort(arr):
    if len(arr)<=1:return arr
    pivot=arr[len(arr)//2];left=[x for x in arr if x<pivot];middle=[x for x in arr if x==pivot];right=[x for x in arr if x>pivot];return quicksort(left)+middle+quicksort(right)
class DataProcessor:
    def __init__(self,data):self.data=data
    def process(self):return [x*2 for x in self.data if x>0]
    def analyze(self):total=sum(self.data);avg=total/len(self.data) if self.data else 0;return{"total":total,"average":avg,"count":len(self.data)}`,
      java: `public class Calculator{private int result;public Calculator(){this.result=0;}public int add(int a,int b){return a+b;}public int subtract(int a,int b){return a-b;}public static void main(String[]args){Calculator calc=new Calculator();System.out.println("5+3="+calc.add(5,3));System.out.println("10-4="+calc.subtract(10,4));}}`,
      cpp: `#include<iostream>
#include<vector>
using namespace std;int fibonacci(int n){if(n<=1)return n;return fibonacci(n-1)+fibonacci(n-2);}class Stack{private:vector<int>data;public:void push(int val){data.push_back(val);}int pop(){if(data.empty())return -1;int val=data.back();data.pop_back();return val;}bool empty(){return data.empty();}};int main(){cout<<"Fibonacci(10)="<<fibonacci(10)<<endl;return 0;}`,
      json: `{"name":"John Doe","age":30,"email":"john@example.com","address":{"street":"123 Main St","city":"New York","country":"USA"},"skills":["JavaScript","Python","Java"],"projects":[{"name":"Project A","status":"completed"},{"name":"Project B","status":"in-progress"}]}`,
      html: `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Sample Page<\/title><style>body{margin:0;padding:20px;}.container{max-width:1200px;margin:0 auto;}<\/style><\/head><body><div class="container"><header><h1>Welcome<\/h1><nav><a href="/">Home<\/a><a href="/about">About<\/a><\/nav><\/header><main><p>Hello World!<\/p><\/main><\/div><\/body><\/html>`,
      css: `.container{display:flex;flex-direction:column;align-items:center;padding:20px;margin:0 auto;max-width:1200px;}.header{background:linear-gradient(135deg,#000,#1a1a1a);color:#fff;padding:30px;border-radius:12px;}.button{background:#d4af37;color:#000;border:none;padding:12px 24px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;}.button:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(212,175,55,0.6);}`,
      sql: `SELECT u.id,u.name,u.email,COUNT(o.id) as order_count,SUM(o.total) as total_spent FROM users u LEFT JOIN orders o ON u.id=o.user_id WHERE u.created_at>='2024-01-01' AND u.status='active' GROUP BY u.id,u.name,u.email HAVING COUNT(o.id)>5 ORDER BY total_spent DESC LIMIT 10;`,
      go: `package main
import("fmt";"sync")
func main(){var wg sync.WaitGroup;nums:=[]int{1,2,3,4,5};results:=make(chan int,len(nums));for _,n:=range nums{wg.Add(1);go func(num int){defer wg.Done();results<-num*num}(n)};wg.Wait();close(results);for r:=range results{fmt.Println(r)}}`,
      rust: `fn main(){let numbers=vec![1,2,3,4,5];let doubled:Vec<i32>=numbers.iter().map(|x|x*2).collect();println!("{:?}",doubled);let sum:i32=numbers.iter().sum();println!("Sum: {}",sum);}struct Rectangle{width:u32,height:u32}impl Rectangle{fn area(&self)->u32{self.width*self.height}}`,
      php: `<?php class UserController{private $db;public function __construct($database){$this->db=$database;}public function getUser($id){$sql="SELECT * FROM users WHERE id=?";$stmt=$this->db->prepare($sql);$stmt->execute([$id]);return $stmt->fetch();}public function createUser($data){$sql="INSERT INTO users(name,email)VALUES(?,?)";$stmt=$this->db->prepare($sql);return $stmt->execute([$data['name'],$data['email']]);}}?>`,
      csharp: `using System;using System.Collections.Generic;using System.Linq;namespace Example{public class Calculator{public int Add(int a,int b)=>a+b;public int Subtract(int a,int b)=>a-b;public static void Main(string[]args){var calc=new Calculator();Console.WriteLine($"5+3={calc.Add(5,3)}");var numbers=new List<int>{1,2,3,4,5};var sum=numbers.Sum();Console.WriteLine($"Sum:{sum}");}}}`
    };

    // DOMå…ƒç´ 
    const inputCode = document.getElementById('inputCode');
    const highlightedCode = document.getElementById('highlightedCode');
    const languageSelect = document.getElementById('language');
    const inputCount = document.getElementById('inputCount');
    const outputCount = document.getElementById('outputCount');
    const statusMessage = document.getElementById('statusMessage');
    const formatInfo = document.getElementById('formatInfo');
    const toast = document.getElementById('toast');

    // æ ¼å¼åŒ–åçš„ä»£ç å­˜å‚¨
    let formattedCode = '';

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      // åŠ è½½é»˜è®¤ç¤ºä¾‹
      loadExample();
      
      // è¯­è¨€åˆ‡æ¢æ—¶åŠ è½½å¯¹åº”ç¤ºä¾‹
      languageSelect.addEventListener('change', loadExample);
      
      // è¾“å…¥ç›‘å¬
      inputCode.addEventListener('input', updateInputCount);
      
      // Tabé”®æ”¯æŒ
      inputCode.addEventListener('keydown', handleTab);
      
      // å¿«æ·é”®
      document.addEventListener('keydown', handleShortcuts);
    });

    // åŠ è½½ç¤ºä¾‹ä»£ç 
    function loadExample() {
      const lang = languageSelect.value;
      inputCode.value = defaultExamples[lang] || defaultExamples.javascript;
      updateInputCount();
      formatCode();
    }

    // æ›´æ–°å­—ç¬¦è®¡æ•°
    function updateInputCount() {
      const count = inputCode.value.length;
      inputCount.textContent = `${count.toLocaleString()} å­—ç¬¦`;
    }

    // å¤„ç†Tabé”®
    function handleTab(e) {
      if (e.key === 'Tab') {
        e.preventDefault();
        const start = this.selectionStart;
        const end = this.selectionEnd;
        this.value = this.value.substring(0, start) + '  ' + this.value.substring(end);
        this.selectionStart = this.selectionEnd = start + 2;
      }
    }

    // å¿«æ·é”®å¤„ç†
    function handleShortcuts(e) {
      if (e.ctrlKey && e.shiftKey && e.key === 'F') {
        e.preventDefault();
        formatCode();
      } else if (e.ctrlKey && e.shiftKey && e.key === 'C') {
        e.preventDefault();
        copyOutput();
      }
    }

    // æ ¼å¼åŒ–ä»£ç 
    function formatCode() {
      const code = inputCode.value.trim();
      if (!code) {
        showToast('è¯·è¾“å…¥ä»£ç ', 'error');
        return;
      }

      const lang = languageSelect.value;
      const startTime = performance.now();

      try {
        formattedCode = formatByLanguage(code, lang);
        const highlighted = highlightSyntax(formattedCode, lang);
        highlightedCode.innerHTML = highlighted;
        
        const endTime = performance.now();
        const duration = (endTime - startTime).toFixed(2);
        
        outputCount.textContent = `${formattedCode.length.toLocaleString()} å­—ç¬¦`;
        statusMessage.textContent = 'æ ¼å¼åŒ–æˆåŠŸ';
        statusMessage.className = 'status-message success';
        formatInfo.textContent = `è€—æ—¶: ${duration}ms | è¯­è¨€: ${getLanguageName(lang)}`;
        
        showToast('ä»£ç æ ¼å¼åŒ–æˆåŠŸ', 'success');
      } catch (error) {
        statusMessage.textContent = 'æ ¼å¼åŒ–å¤±è´¥: ' + error.message;
        statusMessage.className = 'status-message error';
        showToast('æ ¼å¼åŒ–å¤±è´¥', 'error');
      }
    }

    // æ ¹æ®è¯­è¨€æ ¼å¼åŒ–
    function formatByLanguage(code, lang) {
      switch (lang) {
        case 'json':
          return formatJSON(code);
        case 'html':
          return formatHTML(code);
        case 'css':
          return formatCSS(code);
        case 'sql':
          return formatSQL(code);
        case 'javascript':
        case 'java':
        case 'cpp':
        case 'csharp':
        case 'go':
        case 'rust':
        case 'php':
          return formatCStyle(code);
        case 'python':
          return formatPython(code);
        default:
          return formatCStyle(code);
      }
    }

    // JSONæ ¼å¼åŒ–
    function formatJSON(code) {
      try {
        const obj = JSON.parse(code);
        return JSON.stringify(obj, null, 2);
      } catch (e) {
        throw new Error('æ— æ•ˆçš„JSONæ ¼å¼');
      }
    }

    // HTMLæ ¼å¼åŒ–
    function formatHTML(code) {
      let formatted = '';
      let indent = 0;
      const lines = code.replace(/>\s*</g, '>\n<').split('\n');
      
      lines.forEach(line => {
        line = line.trim();
        if (!line) return;
        
        // å‡å°‘ç¼©è¿›çš„æ ‡ç­¾
        if (line.match(/^<\/(div|p|ul|ol|li|table|tr|td|th|thead|tbody|section|article|header|footer|nav|main|aside|form|fieldset|head|body|html)/i)) {
          indent = Math.max(0, indent - 1);
        }
        
        formatted += '  '.repeat(indent) + line + '\n';
        
        // å¢åŠ ç¼©è¿›çš„æ ‡ç­¾ï¼ˆè‡ªé—­åˆæ ‡ç­¾é™¤å¤–ï¼‰
        if (line.match(/^<(div|p|ul|ol|li|table|tr|td|th|thead|tbody|section|article|header|footer|nav|main|aside|form|fieldset|head|body|html)[^>]*>$/i) && 
            !line.match(/\/>$/)) {
          indent++;
        }
      });
      
      return formatted.trim();
    }

    // CSSæ ¼å¼åŒ–
    function formatCSS(code) {
      return code
        .replace(/\s*{\s*/g, ' {\n  ')
        .replace(/\s*}\s*/g, '\n}\n\n')
        .replace(/;\s*/g, ';\n  ')
        .replace(/,\s*/g, ',\n')
        .replace(/\n\s*\n/g, '\n')
        .replace(/  }/g, '}')
        .trim();
    }

    // SQLæ ¼å¼åŒ–
    function formatSQL(code) {
      const keywords = ['SELECT', 'FROM', 'WHERE', 'AND', 'OR', 'JOIN', 'LEFT JOIN', 'RIGHT JOIN', 
                       'INNER JOIN', 'ON', 'GROUP BY', 'ORDER BY', 'HAVING', 'LIMIT', 'OFFSET',
                       'INSERT INTO', 'VALUES', 'UPDATE', 'SET', 'DELETE FROM', 'CREATE TABLE',
                       'ALTER TABLE', 'DROP TABLE', 'UNION', 'UNION ALL'];
      
      let formatted = code.toUpperCase();
      keywords.forEach(kw => {
        formatted = formatted.replace(new RegExp('\\b' + kw + '\\b', 'gi'), '\n' + kw);
      });
      
      return formatted.trim().replace(/^\n/, '');
    }

    // Cé£æ ¼è¯­è¨€æ ¼å¼åŒ–ï¼ˆJS, Java, C++, C#, Go, Rust, PHPï¼‰
    function formatCStyle(code) {
      let formatted = '';
      let indent = 0;
      let inString = false;
      let stringChar = '';
      let prevChar = '';
      
      for (let i = 0; i < code.length; i++) {
        const char = code[i];
        const nextChar = code[i + 1] || '';
        
        // å¤„ç†å­—ç¬¦ä¸²
        if ((char === '"' || char === "'" || char === '`') && prevChar !== '\\') {
          if (!inString) {
            inString = true;
            stringChar = char;
          } else if (char === stringChar) {
            inString = false;
          }
        }
        
        if (inString) {
          formatted += char;
          prevChar = char;
          continue;
        }
        
        // æ ¼å¼åŒ–é€»è¾‘
        if (char === '{') {
          formatted += ' {\n' + '  '.repeat(++indent);
        } else if (char === '}') {
          indent = Math.max(0, indent - 1);
          formatted = formatted.trimEnd() + '\n' + '  '.repeat(indent) + '}\n' + '  '.repeat(indent);
        } else if (char === ';') {
          formatted += ';\n' + '  '.repeat(indent);
        } else if (char === ',' && nextChar !== ' ') {
          formatted += ', ';
        } else if (char === '\n' || char === '\r') {
          // è·³è¿‡åŸæœ‰æ¢è¡Œ
        } else if (char === ' ' && prevChar === ' ') {
          // è·³è¿‡å¤šä½™ç©ºæ ¼
        } else {
          formatted += char;
        }
        
        prevChar = char;
      }
      
      // æ¸…ç†å¤šä½™çš„ç©ºè¡Œå’Œç©ºæ ¼
      return formatted
        .replace(/\n\s*\n\s*\n/g, '\n\n')
        .replace(/{\s*\n\s*\n/g, '{\n')
        .replace(/\n\s*\n\s*}/g, '\n}')
        .trim();
    }

    // Pythonæ ¼å¼åŒ–
    function formatPython(code) {
      let formatted = '';
      let indent = 0;
      const lines = code.split(/[;\n]+/);
      
      lines.forEach(line => {
        line = line.trim();
        if (!line) return;
        
        // å‡å°‘ç¼©è¿›
        if (line.match(/^(return|break|continue|pass|raise)\b/) && indent > 0) {
          // ä¿æŒå½“å‰ç¼©è¿›
        } else if (line.match(/^(else|elif|except|finally)\b/)) {
          indent = Math.max(0, indent - 1);
        }
        
        formatted += '    '.repeat(indent) + line + '\n';
        
        // å¢åŠ ç¼©è¿›
        if (line.match(/:\s*$/)) {
          indent++;
        }
      });
      
      return formatted.trim();
    }

    // è¯­æ³•é«˜äº®
    function highlightSyntax(code, lang) {
      // è½¬ä¹‰HTML
      let escaped = code
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
      
      // ä½¿ç”¨å ä½ç¬¦ä¿æŠ¤å·²å¤„ç†çš„å†…å®¹
      const placeholders = [];
      function addPlaceholder(content, className) {
        const id = `__PH${placeholders.length}__`;
        placeholders.push({ id, content, className });
        return id;
      }
      
      // 1. å…ˆå¤„ç†å­—ç¬¦ä¸²ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œé¿å…å­—ç¬¦ä¸²å†…éƒ¨è¢«é”™è¯¯é«˜äº®ï¼‰
      escaped = escaped.replace(/(["'`])(?:(?!\1)[^\\]|\\.)*\1/g, match => 
        addPlaceholder(match, 'token-string'));
      
      // 2. å¤„ç†æ³¨é‡Š
      escaped = escaped.replace(/\/\/.*$/gm, match => 
        addPlaceholder(match, 'token-comment'));
      escaped = escaped.replace(/\/\*[\s\S]*?\*\//g, match => 
        addPlaceholder(match, 'token-comment'));
      // Pythonæ³¨é‡Šï¼ˆä»…å¯¹Pythonç”Ÿæ•ˆï¼‰
      if (lang === 'python') {
        escaped = escaped.replace(/#.*$/gm, match => 
          addPlaceholder(match, 'token-comment'));
      }
      
      // 3. å¤„ç†æ•°å­—
      escaped = escaped.replace(/\b\d+\.?\d*\b/g, match => 
        addPlaceholder(match, 'token-number'));
      
      // è¯­è¨€ç‰¹å®šå…³é”®å­—
      const keywords = {
        javascript: ['const', 'let', 'var', 'function', 'return', 'if', 'else', 'for', 'while', 'class', 'extends', 'new', 'this', 'async', 'await', 'import', 'export', 'default', 'try', 'catch', 'throw', 'typeof', 'instanceof'],
        python: ['def', 'class', 'return', 'if', 'elif', 'else', 'for', 'while', 'in', 'import', 'from', 'as', 'try', 'except', 'finally', 'raise', 'with', 'lambda', 'yield', 'pass', 'break', 'continue', 'and', 'or', 'not', 'True', 'False', 'None', 'self'],
        java: ['public', 'private', 'protected', 'class', 'interface', 'extends', 'implements', 'static', 'final', 'void', 'int', 'String', 'boolean', 'return', 'if', 'else', 'for', 'while', 'new', 'this', 'super', 'try', 'catch', 'throw', 'throws'],
        cpp: ['int', 'float', 'double', 'char', 'void', 'bool', 'class', 'struct', 'public', 'private', 'protected', 'return', 'if', 'else', 'for', 'while', 'new', 'delete', 'this', 'virtual', 'override', 'const', 'static', 'template', 'typename', 'namespace', 'using', 'include'],
        csharp: ['public', 'private', 'protected', 'class', 'interface', 'struct', 'void', 'int', 'string', 'bool', 'var', 'return', 'if', 'else', 'for', 'foreach', 'while', 'new', 'this', 'base', 'static', 'readonly', 'async', 'await', 'using', 'namespace'],
        go: ['func', 'package', 'import', 'var', 'const', 'type', 'struct', 'interface', 'return', 'if', 'else', 'for', 'range', 'switch', 'case', 'default', 'go', 'chan', 'select', 'defer', 'make', 'new', 'nil', 'true', 'false'],
        rust: ['fn', 'let', 'mut', 'const', 'struct', 'enum', 'impl', 'trait', 'pub', 'use', 'mod', 'return', 'if', 'else', 'for', 'while', 'loop', 'match', 'self', 'Self', 'true', 'false', 'Some', 'None', 'Ok', 'Err'],
        php: ['function', 'class', 'public', 'private', 'protected', 'static', 'return', 'if', 'else', 'elseif', 'for', 'foreach', 'while', 'new', 'this', 'echo', 'print', 'use', 'namespace', 'require', 'include', 'true', 'false', 'null'],
        sql: ['SELECT', 'FROM', 'WHERE', 'AND', 'OR', 'JOIN', 'LEFT', 'RIGHT', 'INNER', 'ON', 'GROUP', 'BY', 'ORDER', 'HAVING', 'LIMIT', 'INSERT', 'INTO', 'VALUES', 'UPDATE', 'SET', 'DELETE', 'CREATE', 'TABLE', 'ALTER', 'DROP', 'AS', 'COUNT', 'SUM', 'AVG', 'MAX', 'MIN', 'DISTINCT'],
        html: ['html', 'head', 'body', 'div', 'span', 'p', 'a', 'img', 'ul', 'ol', 'li', 'table', 'tr', 'td', 'th', 'form', 'input', 'button', 'script', 'style', 'link', 'meta', 'title', 'header', 'footer', 'nav', 'main', 'section', 'article'],
        css: ['display', 'flex', 'grid', 'position', 'margin', 'padding', 'width', 'height', 'color', 'background', 'border', 'font', 'text', 'align', 'justify', 'items', 'content', 'transform', 'transition', 'animation', 'opacity', 'overflow', 'z-index'],
        json: []
      };
      
      // 4. åº”ç”¨å…³é”®å­—é«˜äº®ï¼ˆæ­¤æ—¶å­—ç¬¦ä¸²å’Œæ³¨é‡Šå·²è¢«å ä½ç¬¦ä¿æŠ¤ï¼‰
      const langKeywords = keywords[lang] || keywords.javascript;
      langKeywords.forEach(kw => {
        const regex = new RegExp(`\\b(${kw})\\b`, lang === 'sql' ? 'gi' : 'g');
        escaped = escaped.replace(regex, match => 
          addPlaceholder(match, 'token-keyword'));
      });
      
      // 5. è¿˜åŸæ‰€æœ‰å ä½ç¬¦ä¸ºå®é™…çš„spanæ ‡ç­¾
      placeholders.forEach(ph => {
        escaped = escaped.replace(ph.id, `<span class="${ph.className}">${ph.content}</span>`);
      });
      
      return escaped;
    }

    // å‹ç¼©ä»£ç 
    function minifyCode() {
      const code = inputCode.value.trim();
      if (!code) {
        showToast('è¯·è¾“å…¥ä»£ç ', 'error');
        return;
      }

      const lang = languageSelect.value;
      
      try {
        let minified = code;
        
        if (lang === 'json') {
          minified = JSON.stringify(JSON.parse(code));
        } else if (lang === 'html') {
          minified = code.replace(/>\s+</g, '><').replace(/\s+/g, ' ').trim();
        } else if (lang === 'css') {
          minified = code
            .replace(/\/\*[\s\S]*?\*\//g, '')
            .replace(/\s+/g, ' ')
            .replace(/\s*([{}:;,>+~])\s*/g, '$1')
            .trim();
        } else {
          // é€šç”¨å‹ç¼©ï¼šç§»é™¤æ³¨é‡Šå’Œå¤šä½™ç©ºç™½
          minified = code
            .replace(/\/\/.*$/gm, '')
            .replace(/\/\*[\s\S]*?\*\//g, '')
            .replace(/#.*$/gm, '')
            .replace(/\s+/g, ' ')
            .replace(/\s*([{}();,:])\s*/g, '$1')
            .trim();
        }
        
        formattedCode = minified;
        highlightedCode.innerHTML = highlightSyntax(minified, lang);
        outputCount.textContent = `${minified.length.toLocaleString()} å­—ç¬¦`;
        
        const ratio = ((1 - minified.length / code.length) * 100).toFixed(1);
        statusMessage.textContent = 'å‹ç¼©æˆåŠŸ';
        statusMessage.className = 'status-message success';
        formatInfo.textContent = `å‹ç¼©ç‡: ${ratio}% | å‡å°‘äº† ${(code.length - minified.length).toLocaleString()} å­—ç¬¦`;
        
        showToast(`ä»£ç å‹ç¼©æˆåŠŸï¼Œå‡å°‘äº† ${ratio}%`, 'success');
      } catch (error) {
        statusMessage.textContent = 'å‹ç¼©å¤±è´¥: ' + error.message;
        statusMessage.className = 'status-message error';
        showToast('å‹ç¼©å¤±è´¥', 'error');
      }
    }

    // å¤åˆ¶è¾“å‡º
    function copyOutput() {
      if (!formattedCode) {
        showToast('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', 'error');
        return;
      }

      navigator.clipboard.writeText(formattedCode).then(() => {
        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
      }).catch(() => {
        // é™çº§æ–¹æ¡ˆ
        const textarea = document.createElement('textarea');
        textarea.value = formattedCode;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
      });
    }

    // æ¸…ç©º
    function clearAll() {
      inputCode.value = '';
      highlightedCode.innerHTML = '';
      formattedCode = '';
      inputCount.textContent = '0 å­—ç¬¦';
      outputCount.textContent = '0 å­—ç¬¦';
      statusMessage.textContent = 'å·²æ¸…ç©º';
      statusMessage.className = 'status-message';
      formatInfo.textContent = '';
      showToast('å·²æ¸…ç©ºæ‰€æœ‰å†…å®¹', 'success');
    }

    // è·å–è¯­è¨€åç§°
    function getLanguageName(lang) {
      const names = {
        javascript: 'JavaScript',
        python: 'Python',
        java: 'Java',
        cpp: 'C/C++',
        csharp: 'C#',
        html: 'HTML',
        css: 'CSS',
        json: 'JSON',
        sql: 'SQL',
        go: 'Go',
        rust: 'Rust',
        php: 'PHP'
      };
      return names[lang] || lang;
    }

    // Toasté€šçŸ¥
    function showToast(message, type = 'success') {
      toast.textContent = message;
      toast.className = 'toast ' + type + ' show';
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2500);
    }
  </script>
</body>
</html>
