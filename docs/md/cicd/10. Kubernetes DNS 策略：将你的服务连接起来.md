`A服务` 依赖另一个 `B服务` ，而我们常常不知道 `B服务` 的端口和IP，且端口和IP也相对不固定有可能经常更改。

这时候，我们就需要一个神器 —— **服务发现**

## 什么是服务发现

> 服务发现是指使用一个注册中心来记录分布式系统中的全部服务的信息，以便其他服务能够快速的找到这些已注册的服务。

当我们通过域名访问一个网站时，浏览器不会直接访问域名。而是先将域名发送至 `DNS` 服务器，获取到域名对应的IP后，再通过IP去访问真实服务器（如下图）。

![](../youdaonote-images/Pasted%20image%2020230426191112.png)

**我们日常上网，DNS服务器 将域名映射为真实IP的过程，就是一个服务发现的过程**。而我们再也不需要记住每个网站的IP，只需要记住永远不会更改的**域名**即可。

那么在 `Kubernetes` 中，如何做服务发现呢？我们前面写到过， `Pod` 的 `IP` 常常是漂移且不固定的，所以我们要使用 `Service` 这个神器来将它的访问入口固定住。

但是，我们在部署 `Service` 时，也不知道部署后的ip和端口如何。那么在 `Kubernetes` 中，我们可以利用 `DNS` 的机制给每个 `Service` 加一个内部的**域名**，指向其真实的IP。

## Kubernetes CoreDNS

在`Kubernetes`中，对 `Service` 的服务发现，是通过一种叫做 `CoreDNS` 的组件去实现的。

`CoreDNS` 是使用 `Go` 语言实现的一个DNS服务器。当然，它也不只是可以用在 `Kubernetes` 上。也可以用作日常 `DNS` 服务器使用。在 `Kubernetes` 1.11版本后，`CoreDNS` 已经被默认安装进了 `Kubernetes` 内。

我们也通过下面的命令验证下 `CoreDNS` 是否已经安装成功：

```shell
kubectl -n kube-system get all  -l k8s-app=kube-dns -o wide
```

![](../youdaonote-images/Pasted%20image%2020230426191714.png)