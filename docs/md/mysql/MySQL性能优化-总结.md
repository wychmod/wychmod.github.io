# 1. 优化思路

![](../youdaonote-images/Pasted%20image%2020230711230646.png)

# 2. 连接——配置优化

客户端连接到服务端，有可能是服务端连接数不够导致应用程序获取不到连接。

可以从两个方面来解决连接数不够的问题:
1. 从服务端来说，我们可以增加服务端的可用连接数
	1. 增加可用连接数，修改max_connections的大小
	2. 及时释放不活动连接，交互武和非交豆式的客广蹦的默以超的时 间都是28800 秒，8 小时，我们可以把这个值调小。
2. 从客户端来说，可以减少从服务端获取的连接数。如果我们想要不是每一次执行SQL都创建一个新的连接。**引入连接池，实现连接的重用**。阿里的Druid、Hikari。
	连接池并不是越大越好，只要维护一定数量大小的连接池，其他的客户端排队等待获取连接就可以了。有的时候连接池越大，效率反而越低。

每一个连接，服务端都需要创建一个线程去处理它。连接数越多，服务端创建的线程数就会越多。CPU的核数是有限的，频繁的上下文切换会造成比较大的性能开销。

> 建议是机器核数乘以2加1

# 3. 缓存——架构优化

## 3.1 缓存

可以把数据放到内存缓存起来，比如使用 Redis 。

## 3.2 集群，主从复制

集群的话必然会面临一个问题，就是不同的节点之问数据一致性的问题。如果同时 读写多台数据库节点，怎么让所有的节点数据保持一致?

这个时候我们需要用到复制技术 (repli cation )，被复制的节点称为ma st er ，复制 的节点称为slave。slave 本身也可以作为其他节点的数据来源，这个叫做级联复制。